<div class="dashboard-container">
  <div class="dashboard-content">
    @if (portfolios().length === 0 && !loading()) {
    <!-- Empty State -->
    <lib-empty-state
      [icon]="'account_balance_wallet'"
      [title]="'No Portfolios Yet'"
      [message]="'Get started by creating your first portfolio to track your investments'"
      [buttonConfig]="{ label: 'Create Portfolio' }"
      (actionClick)="onCreatePortfolio()"
    />
    } @else {
    <!-- Page Header -->
    <lib-page-header
      [config]="pageHeaderConfig()"
      (menuItemClicked)="onHeaderMenuItemClick($event)"
    />

    <!-- Portfolio Widgets -->
    @if (!loading() && selectedPortfolioId()) {
      <div class="portfolio-widgets">
        <lib-net-account-value-widget
          [value]="netAccountValue()"
          [buyingPower]="buyingPower()"
        />
      </div>
    }

    <!-- Asset List -->
    @if (loading()) {
    <!-- Loading State -->
    <lib-loading-page
      [config]="{
          title: 'Loading Portfolio Data...',
          subtitle: 'Please wait while we fetch your portfolios and assets'
        }"
    />
    } @else if (selectedPortfolioId()) {
    <lib-card
      title="Portfolio Assets"
      [subtitle]="assets().length + ' positions'"
      [headerActions]="true"
      class="assets-table"
    >
      <!-- Header Actions -->
      <div headerActions>
        <lib-button [config]="viewTransactionsButtonConfig" (clicked)="onViewTransactions()" />
        <lib-button [config]="buyAssetButtonConfig" (clicked)="onBuyAsset()" />
      </div>

      <!-- Content -->
      @if (assets().length === 0) {
      <!-- Empty State for Assets -->
      <lib-empty-state
        [icon]="'inventory_2'"
        [title]="'No Assets Yet'"
        [message]="'Buy your first asset to start tracking this portfolio'"
        [buttonConfig]="{ label: 'Buy Asset' }"
        (actionClick)="onBuyAsset()"
      />
      } @else {
      <lib-table
        [data]="assets()"
        [columns]="assetColumns"
        [actionsTemplate]="assetActions"
        [scrollable]="true"
      >
      </lib-table>
      }
    </lib-card>
    } }
  </div>
</div>

<!-- Asset Actions Template -->
<ng-template #assetActions let-asset>
  <div class="asset-actions">
    <lib-action-menu
      [config]="getAssetActionsMenuConfig(asset)"
      (itemSelected)="onAssetActionSelected(asset, $event)"
    />
  </div>
</ng-template>
